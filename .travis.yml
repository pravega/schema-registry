#
# Copyright (c) 2017 Dell Inc., or its subsidiaries. All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
language: java
install: true
jdk:
- openjdk8

env:
  global:
  - GRADLE_OPTS="-Xms128m"

jobs:
  include:
    # the secure configurations in env: is for BINTRAY_USER=<USER> and BINTRAY_KEY=<KEY> properties
    # which will be used for publishing artifacts to snapshot repository
  - stage: build
    if: type IN (push, pull_request)
    install: ./gradlew assemble
    script: ./gradlew check

  - stage: javadocs
    install: echo "Building javadocs"
    script: ./gradlew javadocs

  - stage: snapshot
    env:
       - secure: "DQ0hTuDuX2wl/AtJYdCSAvek5ZdmmdiTThhVfp/Kw7yEFfIPKLRYhz28UF5DeyPGBmEEVoYjWxo1MNfWBNPuihu2dj5Fe3mZ44lf6E2/IuGhgEKKrErvgaJZyObboS49tC+nhPQeRaMEnGw4R9l59u8CkHbaWL06oL/yVad+9wbekX5dR41kDUobGIUjCqgrf0tMHILTecsufOiQswzsKO2OlXdjagcojbmHTCWvYHPEZLuY28fxxsy4oFkMkvxss0XmJtdsL1OdXp/EhN1hEV0m0Jw9ZWHzDee57fs7v97T+zrZSS5PSFWbU0bAslzN4lAdERijZXq3fn8HPLd8P+eZJtfU87FCjB/4h3uREfKkYzbsfd78SFzE4wYQR7sB5iUyN6Z0WHoxZgIOQqm3sCqBNUgWQ7KDAWimr3NE8YF3FOEfQCo9Ou/SxcTlujiickmhDcMwBuKXerXOGmeiQjuqfPjuq4o/IcYUu2CYME7KTzgLgVFgtwjiRKttQHbrNiF/iMJecwRNLjWVrdj9iWJ7lhpSPtfKXV5dQuU2FSBISQOy2CU1dU3MQG5ukmSnsVJNefPME9tEg8gkSllSLspoX6QWparfZ0mwUyqUg4W16FCM4q0FgKjcDD0OEb7m23DfP9nX6ztSYBcgMdCdiMsTAisdrh0RiWWby0uxi0I=" 
       - secure: "iO4b39q1k1Z27CPNdLvijzmL/aoVy7LmnzZZoVof5Kuuj4FX8N1Rk5XqLG8eObiigkXcXApmmNZjF9ArGB2w/QJtdGSnWZqWk4oFHJjW9eXCZmY0STv9vSeQb2X0liPRT+PydS4TYFb4M1W6pWKMEBkfZGFOofaFyqz7BRn+rFMunZAgRY7tvZAr+7ZeO5+/Q3ugLEn6ukWLxtYhuLTLWK0UnZFSj0BvtsodMNdBuSMPGk4AQtgQ612dK/IaIJSh7yFjlhw+qYjZzUaepuPl1HYxh/3k5f/GCoMupcx3B4btoxagtY0IaX74UZeVU4uG7q8ODNGOTZFV2hv7WrdRZp12A0ah2e+Q0U+7e9B2pVV+UCyayqXOMEgg4rK3UaYGpPnyKS6d+OMJtSAhjdNcGQIs4ZH4y+VEGZPhfS+xV0qndearUNiMcLXi28Hwc0d4P2X/I+iNHx0//Hh6KpUs4NocXbpsYlvLcdrXHuQbXt5K7H+ZDTOORVcWOWTxl9YQMENc6/XzwsAMZND1P+pExAMV+rY/5UKtlJX2vUpsZCxuDIqheuG4enAf9VUw7EYJurllMMoHtBqh4yhI7aSOgIyUyfXN2EljWgd73sDBF+EZuitMc1hMrbh6m9MpQwUNx7RfFv8S30zEbCQTlX7xuglhUJkxBbZF7LvlLIIbXi4="
    install: skip
    script:  echo USER=$BINTRAY_USER ; echo KEY=$BINTRAY_KEY ; ./gradlew publish -PpublishUrl=jcenterSnapshot -PpublishUsername=$BINTRAY_USER -PpublishPassword=$BINTRAY_KEY

sudo: required

services:
- docker

cache:
  directories:
  - ".gradle"
  - "$HOME/.gradle"
  - "$HOME/.m2"
