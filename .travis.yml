#
# Copyright (c) 2017 Dell Inc., or its subsidiaries. All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
language: java
install: true
jdk:
- openjdk8

env:
  global:
  - GRADLE_OPTS="-Xms128m"

jobs:
  include:
  - stage: build
    if: type IN (push, pull_request)
    install: ./gradlew assemble
    script: ./gradlew check

  - stage: snapshot
    env:
       - secure: "abpOwhs4UfFH0wMwGnKRbQ0vCEJtZ5pffNtTTfp2/6OdYU6aTyE+YwalmMxyqZtodpWQoRPLFXlNW0aRATYdUStAm9osG0ZIltBzpuX8NjAXUe49PA0+QFhiAus1TMYBlacGt8CKwkIR2UBgIViA/TL0KoYb/677fCQLG4JcvGmQGYOBNQoBNtYl5xAviFxQ1LxgzAzDuZFnwwpugUJHEj6engcqpsZz7fe/gGdEJlFxUUxjEDRGGj0oK1rCWqNSmFhj3mzPGnNMYPbFS+gRIaWYxaCGlcjx7brgQlImIPUazTtYc5NyRwq0KTrYuvArxQyc9tZDrNMduUonK5laF/n9/uIV66qZGYkzVYBOiMO/+LnOqjL+VF8Vuan55sammLJRGrmWT8HDs43pEyOBTk41i4Q1dNnS1HQa2yq8gfa6jlArg27ownxgTChaCwjWSQtXSk1XXoHcritpLKkRrqhGwj6Gde6OEtnvaaHK8K0z+dBZYOkfZQv1W7c7NGOuvxlh2N3ajDix3sKi6ylm4oObdMotPeMtmHmBtjMVL/JH5fKfG29WVzX1uIO7X0ylr0ZxXX0T24xvhlXOoVT9dz2uF426pNOZfa+T715d+zfmhkHkpOWSIHUeMCH7PXxN61WB5jfunSO5wzgR8BsQeAWwxvxj6rYgHFmR2enIrKU="
       - secure: "MSONZLyBts5zDpJP3sYhg01n53DAkclYLiOdPYdE89HMjzSPrZi7YIbsN+jBUVMUWf3q7DKBf89x3SfRquMBtKWoELMq1FX2iPGi6RPiphFqEgix9Hgw5CRhyp3K/fRBjM7rhnj3/CnBY/lfWXPaUhefwqKW3iJ/pg/ph8fballn9yEr0Vi0YXGOT55RgU4jdgOgz5rf0kb4NybsniqyTKcxJrKnxHz3/vDYRB02e1fxYwwzkXRAaTSPC18yA75/NpAweszU4nF+zhebdfkIaxRf12TYoiY/xM6AUnyXSc4l6r2bDjkQtL/vPN6xy+V4gT3vp7OG/OZJxBHj88dbjh0uiZQymRTO3YIglerRhPAopILhymGw5kDJvElNHxuCblJyUG68pE7BX5U2ba3cP2xYhuadoZ3O2qFGH6Nx2ZNLhXpG0dspngxX9Abafc72dTBW9QAdSTdLQU0EiTZhLjM5Rl/4DWtwB2zzPxJagj4M/KyICLd+9fJXxgT9XbEkSN4C1HeOu6g1ToMZuDq+cCy37PSzN6PADaW+5URJbm/y/J2gv93z3vBNP/5ZPec/AgEsIfi0ZyB6qOjINnDYPgAQzmjsBhSC3J3jL5J+m+TO2j1Blwd21WZ9LTWkwHir4DeQP4FwMh3Na+4DvsAfuD2dfoAfUazmdDYHoXS3cC8="
    install: skip
    script:  echo USER=$BINTRAY_USER ; echo KEY=$BINTRAY_KEY ; ./gradlew publish -PpublishUrl=jcenterSnapshot -PpublishUsername=$BINTRAY_USER -PpublishPassword=$BINTRAY_KEY
sudo: required

services:
- docker

cache:
  directories:
  - ".gradle"
  - "$HOME/.gradle"
  - "$HOME/.m2"
